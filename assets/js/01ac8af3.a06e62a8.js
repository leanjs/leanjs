"use strict";(self.webpackChunk_leanjs_website=self.webpackChunk_leanjs_website||[]).push([[468],{5318:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(7378);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var p=n.createContext({}),i=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=i(e.components);return n.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=i(a),m=l,h=d["".concat(p,".").concat(m)]||d[m]||u[m]||o;return a?n.createElement(h,r(r({ref:t},c),{},{components:a})):n.createElement(h,r({ref:t},c))}));function m(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var o=a.length,r=new Array(o);r[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:l,r[1]=s;for(var i=2;i<o;i++)r[i]=a[i];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},5608:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>i});var n=a(5773),l=(a(7378),a(5318));const o={title:"Development notes"},r="Development notes",s={unversionedId:"development-notes",id:"development-notes",title:"Development notes",description:"Here are some development notes that may be useful to you if you decide to contribute to the project.",source:"@site/../docs/development-notes.md",sourceDirName:".",slug:"/development-notes",permalink:"/docs/development-notes",draft:!1,editUrl:"https://github.com/leanjs/leanjs/edit/main/docs/../docs/development-notes.md",tags:[],version:"current",frontMatter:{title:"Development notes"},sidebar:"defaultSidebar",previous:{title:"Contributing",permalink:"/docs/contributing"}},p={},i=[{value:"No examples in workspaces",id:"no-examples-in-workspaces",level:2},{value:"Experimenting with packages",id:"experimenting-with-packages",level:2},{value:"Using e2e/test-subjects",id:"using-e2etest-subjects",level:3},{value:"Using yalc",id:"using-yalc",level:3},{value:"yalc walkthrough",id:"yalc-walkthrough",level:4},{value:"Single-version policy",id:"single-version-policy",level:2}],c={toc:i};function u(e){let{components:t,...a}=e;return(0,l.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"development-notes"},"Development notes"),(0,l.kt)("p",null,"Here are some development notes that may be useful to you if you decide to contribute to the project."),(0,l.kt)("h2",{id:"no-examples-in-workspaces"},"No examples in workspaces"),(0,l.kt)("p",null,"The LeanJs monorepo has different workspaces; as you can see ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/leanjs/leanjs/blob/main/package.json#L27"},"here"),", the examples folder is not one of them.\nThe reason is that when we install dependencies at the root of the monorepo it could take a lot of time if there are a lot of workspaces with many different dependencies, which slows down CI, our local dev, etc.\nWhen we run yarn in the root directory, yarn installs the dependencies, and if a local package depends on some LeanJS package (e.g. ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/leanjs/leanjs/blob/main/e2e/test-subjects/package-leanjs-react-18/package.json#L23"},"e2e/test-subjects/package-leanjs-react-18"),") then yarn will create a symlink in the node_modules to the local LeanJS package."),(0,l.kt)("h2",{id:"experimenting-with-packages"},"Experimenting with packages"),(0,l.kt)("h3",{id:"using-e2etest-subjects"},"Using e2e/test-subjects"),(0,l.kt)("p",null,"If you want to experiment with some LeanJS packages by making changes and running them in an app, the easiest way is to use any of the ",(0,l.kt)("strong",{parentName:"p"},"e2e/test-subjects")," apps because they are part of the workspaces. This is what I normally do. Heads up! because we export the output of the build in the dist folder, we need to run ",(0,l.kt)("strong",{parentName:"p"},"yarn build")," in the LeanJS package that you are changing so you can use those changes in the e2e test app."),(0,l.kt)("h3",{id:"using-yalc"},"Using yalc"),(0,l.kt)("p",null,"If you want to make changes in a LeanJS package and use that in an example folder, then you have to create a symlink to replicate the above functionality. You have two options of that:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://classic.yarnpkg.com/lang/en/docs/cli/link/"},"yarn link")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/wclr/yalc"},"yalc"))),(0,l.kt)("p",null,"In my experience using ",(0,l.kt)("strong",{parentName:"p"},"yarn link")," I had sometimes issues when a linked dependency had a dependency on another package that was also local and it was also linked, e.g. @leanjs/react depends on @leanjs/core. So I prefer to use ",(0,l.kt)("strong",{parentName:"p"},"yalc")," which has worked always fine for me.\nBear in mind that in either case, ",(0,l.kt)("strong",{parentName:"p"},"yarn link")," or ",(0,l.kt)("strong",{parentName:"p"},"yalc"),", you\u2019ll have to do ",(0,l.kt)("strong",{parentName:"p"},"yarn build every time that you make changes in the local @leanjs package to be able to execute those changes in your \u201clinked\u201d app"),"."),(0,l.kt)("h4",{id:"yalc-walkthrough"},"yalc walkthrough"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Install:")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"yarn global add yalc\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"if you want experiment with the vue-router package:")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd packages/vue-router/\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"make your changes, then build and publish the package @leanjs/vue-router locally in a local store in the folder ~/.yalc/")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"yarn build\nyalc publish\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"now to use this local package in our dependant example (eg. the coolest-todos)")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd ../../\ncd examples/coolest-todos/\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"install the local package in the example")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"yalc add @leanjs/vue-router@0.7.5\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"add yalc local repo in workspaces")),(0,l.kt)("p",null,"NOTE form yalc documentation:"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"using yarn workspaces, --pure option will be used by default, so package.json and modules folder will not be touched. Then you add yalc'ed package folder to workspaces in package.json (you may just add .yalc/",(0,l.kt)("em",{parentName:"p"}," and .yalc/@"),"/","*"," patterns). While update (or push) operation, packages content will be updated automatically and yarn will care about everything else. If you want to override default pure behavior use --no-pure flag.")),(0,l.kt)("p",null,"so, add ",(0,l.kt)("inlineCode",{parentName:"p"},".yalc/* ")," and ",(0,l.kt)("inlineCode",{parentName:"p"},".yalc/@*/*")," as workpackages in the example root package.json"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'...\n\n"workspaces": [\n    "apps/*",\n    "composable-apps/*",\n    "packages/*",\n\n    ".yalc/*",\n    ".yalc/@*/*"\n  ],\n\n')),(0,l.kt)("p",null,"and run"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"yarn\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"so, run the example")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"yarn dev\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"when you're done to roll back the changes yalc made, remove all installed packages from yalc")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},"cd examples/coolest-todos/\n\nyalc remove --all\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"remove previously added yalc repo from workspaces")),(0,l.kt)("h2",{id:"single-version-policy"},"Single-version policy"),(0,l.kt)("p",null,"When working on a monorepo, the peerDependencies should point to an asterisk (","*",") as version in each package except the root package.\nThen we can bump a given dependency in all the packages by changing the version in one place.\nThis is an implementation of something called single-version policy, which is something most monorepo tools recommend. All the packages in the monorepo use the same version. This is to avoid a ",(0,l.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Dependency_hell"},"dependency hell"),"."))}u.isMDXComponent=!0}}]);